<!-- TEST 20:09 -->
<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Stick Figure Trial</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    background: black;
    overflow: hidden;
  }
  canvas {
    display: block;
  }
</style>
</head>

<body>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// ===== PLAYER =====
const player = {
  x: 100,
  y: canvas.height - 150,
  vx: 0,
  vy: 0,
  w: 20,
  h: 60,
  onGround: false
};

// ===== PHYSICS =====
const gravity = 0.8;
const speed = 4;
const jump = -14;

// ===== OBSTACLES =====
const obstacles = [
  { x: 300, y: canvas.height - 80, w: 120, h: 20 },
  { x: 520, y: canvas.height - 140, w: 120, h: 20 },
  { x: 760, y: canvas.height - 200, w: 120, h: 20 }
];

// ===== INPUT =====
const keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

// ===== GAME LOOP =====
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

// ===== UPDATE =====
function update() {
  // Bewegung
  if (keys["ArrowLeft"]) player.vx = -speed;
  else if (keys["ArrowRight"]) player.vx = speed;
  else player.vx = 0;

  if (keys[" "] && player.onGround) {
    player.vy = jump;
    player.onGround = false;
  }

  player.vy += gravity;
  player.x += player.vx;
  player.y += player.vy;

  // Boden
  if (player.y + player.h > canvas.height - 20) {
    player.y = canvas.height - 20 - player.h;
    player.vy = 0;
    player.onGround = true;
  }

  // Kollision Hindernisse
  obstacles.forEach(o => {
    if (
      player.x < o.x + o.w &&
      player.x + player.w > o.x &&
      player.y < o.y + o.h &&
      player.y + player.h > o.y
    ) {
      // von oben landen
      if (player.vy > 0) {
        player.y = o.y - player.h;
        player.vy = 0;
        player.onGround = true;
      }
    }
  });
}

// ===== DRAW =====
function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Boden
  ctx.fillStyle = "#222";
  ctx.fillRect(0, canvas.height - 20, canvas.width, 20);

  // Hindernisse
  ctx.fillStyle = "#555";
  obstacles.forEach(o => {
    ctx.fillRect(o.x, o.y, o.w, o.h);
  });

  drawStickFigure(player.x, player.y);
}

// ===== STICK FIGURE =====
function drawStickFigure(x, y) {
  ctx.strokeStyle = "white";
  ctx.lineWidth = 2;

  // Kopf
  ctx.beginPath();
  ctx.arc(x + 10, y - 10, 10, 0, Math.PI * 2);
  ctx.stroke();

  // KÃ¶rper
  ctx.beginPath();
  ctx.moveTo(x + 10, y);
  ctx.lineTo(x + 10, y + 30);
  ctx.stroke();

  // Arme
  ctx.beginPath();
  ctx.moveTo(x - 5, y + 15);
  ctx.lineTo(x + 25, y + 15);
  ctx.stroke();

  // Beine
  ctx.beginPath();
  ctx.moveTo(x + 10, y + 30);
  ctx.lineTo(x - 5, y + 55);
  ctx.moveTo(x + 10, y + 30);
  ctx.lineTo(x + 25, y + 55);
  ctx.stroke();
}

loop();
</script>
</body>
</html>
