<!-- TEST 13:10 -->
<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Pfeil-Wurm Test</title>
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: #111;
    color: white;
    font-family: sans-serif;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(6, 60px);
    grid-template-rows: repeat(6, 60px);
    gap: 5px;
  }
  .cell {
    background: #222;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-size: 24px;
    transition: transform 0.5s ease;
    border-radius: 8px;
  }
  .moving {
    position: absolute;
    z-index: 100;
    transition: all 0.5s ease;
  }
</style>
</head>
<body>

<div class="grid" id="grid"></div>

<script>
const grid = document.getElementById("grid");
const size = 6;

// Richtungen: ↑, →, ↓, ←
const arrows = ["↑","→","↓","←"];

// Pfad des Wurms: Array von [row,col,direction]
let worm = [
  [0,0,"→"], [0,1,"→"], [0,2,"↓"], [1,2,"↓"],
  [2,2,"←"], [2,1,"←"], [2,0,"↓"], [3,0,"→"]
];

// Erzeuge Grid
const cells = [];
for(let r=0;r<size;r++){
  for(let c=0;c<size;c++){
    const div = document.createElement("div");
    div.className="cell";
    div.dataset.row=r;
    div.dataset.col=c;
    grid.appendChild(div);
    cells.push(div);
  }
}

// Setze Pfeile
worm.forEach(([r,c,direction],index)=>{
  const cell = cells[r*size+c];
  cell.textContent = direction;
  cell.dataset.index = index; // Index im Wurm
  cell.onclick = ()=>moveArrow(index);
});

function moveArrow(startIndex){
  const [r,c,direction] = worm[startIndex];
  const cell = cells[r*size+c];
  // Erstelle Kopie für Animation
  const arrow = document.createElement("div");
  arrow.className="cell moving";
  arrow.textContent = direction;
  const rect = cell.getBoundingClientRect();
  arrow.style.left = rect.left + "px";
  arrow.style.top = rect.top + "px";
  document.body.appendChild(arrow);

  let dr=0,dc=0;
  if(direction==="↑") dr=-1;
  if(direction==="↓") dr=1;
  if(direction==="→") dc=1;
  if(direction==="←") dc=-1;

  const steps = 2; // wie viele Zellen fliegen
  const targetRow = r + dr*steps;
  const targetCol = c + dc*steps;

  const targetCell = cells[targetRow*size + targetCol];
  const targetRect = targetCell.getBoundingClientRect();

  setTimeout(()=>{
    arrow.style.left = targetRect.left + "px";
    arrow.style.top = targetRect.top + "px";
  },50);

  // Nach Animation entfernen
  setTimeout(()=>{
    arrow.remove();
    alert("Pfeil ist angekommen!");
  },600);

  // Deaktiviere Klick
  cell.onclick = null;
}
</script>
</body>
</html>
