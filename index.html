<!-- TEST 20:09 -->
<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Stick Jump</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin:0; background:black; overflow:hidden; }
  canvas { display:block; }
</style>
</head>

<body>
<canvas id="c"></canvas>

<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");

c.width = innerWidth;
c.height = innerHeight;

// ===== PLAYER =====
const player = {
  x: 140,
  y: 0,
  baseY: c.height - 120,
  vy: 0,
  r: 12,
  jumping: false
};

// ===== OBSTACLES =====
let obstacles = [];
let speed = 4;
let gravity = 0.7;
let jumpPower = -14;

// ===== INPUT =====
addEventListener("keydown", e => {
  if(e.code === "Space") jump();
});
addEventListener("touchstart", jump);

function jump(){
  if(!player.jumping){
    player.vy = jumpPower;
    player.jumping = true;
  }
}

// ===== RESET =====
function reset(){
  obstacles = [];
  player.y = player.baseY;
  player.vy = 0;
  player.jumping = false;
}

// ===== SPAWN OBSTACLE =====
function spawnObstacle(){
  obstacles.push({
    x: c.width + 40,
    y: player.baseY + 25,
    r: 16
  });
}

// ===== DRAW STICK =====
function drawStick(){
  ctx.strokeStyle = "white";
  ctx.lineWidth = 2;

  // head
  ctx.beginPath();
  ctx.arc(player.x, player.y - 20, player.r, 0, Math.PI*2);
  ctx.stroke();

  // body
  ctx.beginPath();
  ctx.moveTo(player.x, player.y - 8);
  ctx.lineTo(player.x, player.y + 30);
  ctx.stroke();

  // arms
  ctx.beginPath();
  ctx.moveTo(player.x - 12, player.y + 5);
  ctx.lineTo(player.x + 12, player.y + 5);
  ctx.stroke();

  // legs
  ctx.beginPath();
  ctx.moveTo(player.x, player.y + 30);
  ctx.lineTo(player.x - 10, player.y + 50);
  ctx.moveTo(player.x, player.y + 30);
  ctx.lineTo(player.x + 10, player.y + 50);
  ctx.stroke();
}

// ===== LOOP =====
let frame = 0;
function loop(){
  ctx.clearRect(0,0,c.width,c.height);

  // ground
  ctx.strokeStyle="#333";
  ctx.beginPath();
  ctx.moveTo(0, player.baseY + 50);
  ctx.lineTo(c.width, player.baseY + 50);
  ctx.stroke();

  // gravity
  player.vy += gravity;
  player.y += player.vy;

  if(player.y >= player.baseY){
    player.y = player.baseY;
    player.vy = 0;
    player.jumping = false;
  }

  // spawn obstacles
  frame++;
  if(frame % 100 === 0) spawnObstacle();

  // move + draw obstacles
  obstacles.forEach(o=>{
    o.x -= speed;

    ctx.fillStyle = "#666";
    ctx.beginPath();
    ctx.arc(o.x, o.y, o.r, 0, Math.PI*2);
    ctx.fill();

    // collision (circle vs body)
    const dx = player.x - o.x;
    const dy = (player.y + 25) - o.y;
    const dist = Math.sqrt(dx*dx + dy*dy);

    if(dist < o.r + 15){
      reset();
    }
  });

  obstacles = obstacles.filter(o => o.x > -50);

  drawStick();
  requestAnimationFrame(loop);
}

reset();
loop();
</script>
</body>
</html>
